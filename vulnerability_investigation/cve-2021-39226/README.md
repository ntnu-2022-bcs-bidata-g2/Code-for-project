# CVE-2021-39226 - Grafana Snapshot Authentication Bypass

## Setting up environment
Run ```./run.sh up -d``` in the ```environment``` folder to set up and configure containers.     
Run ```./run.sh down``` to stop the containers.  

Note that the script sleeps for 10 seconds to give the containers time to start up before creating snapshots, so if your computer is slow you might have to change this to a higher number if a curl error is returned. 

## Scanning environment
Run ```nuclei -t cve-2021-39226.yaml -l targets.txt``` to test if instances are vulnerable.  
It should report that only the instance running on port 3000 (unless changed) is vulnerable. 

## References:
List of references that were used:
- https://grafana.com/docs/grafana/latest/http_api/snapshot/
- https://github.com/projectdiscovery/nuclei-templates/blob/master/cves/2021/CVE-2021-39226.yaml
